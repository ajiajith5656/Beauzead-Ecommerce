#set($now = $util.time.nowISO8601())

## Get current status first
{
  "version": "2017-02-28",
  "operation": "UpdateItem",
  "key": {
    "productId": $util.dynamodb.toDynamoDBJson($ctx.args.id)
  },
  "update": {
    "expression": "SET is_active = if_not_exists(is_active, :false), is_active = NOT is_active, updated_at = :now",
    "expressionValues": {
      ":false": $util.dynamodb.toDynamoDBJson(false),
      ":now": $util.dynamodb.toDynamoDBJson($now)
    }
  }
}
